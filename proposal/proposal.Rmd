---
title: "How Does Hollywood Bring In the Big Bucks?"
author: "zuck(R)berg"
date: "03/29/19"
output: github_document
---

## Section 1. Introduction


The dataset we are using is “TMBD 5000 Movie Dataset.” 

Originally, we found this set on kaggle.com. The data originates from “The Movie Database” API, it was collected from this original dataset. Each case, or observation, represents a film.

The data’s variables: 
budget
genres
homepage
id
keywords
original_language
original_title
overview
popularity
production_companies
production_countries
release_date
revenue
runtime
spoken_languages
status
tagline
title
vote_average
Vote_count

We aim to investigate which features of a movie correspond to higher profits. Which variables from the dataset correlate to a high revenue rate? 

## Section 2. Data Analysis Plan

Our outcome variable is revenue, and predictors would include but not be limited to the following variables: budget, production_companies, keywords, spoken_languages, original_language, release_date, and vote_average. Possible comparison groups include 

```{r load-data, message=FALSE}
library(tidyverse)

movies <- read_csv("tmdb_5000_movies.csv")
movies <- movies %>%
  select(-id, -homepage, -original_title, -popularity)
```

We remove the variables id, homepage, original_title, and popularity to form an updated 16 column dataset- we will not use these in our analysis. We also filter the data so we will only be considering released movies, not rumored movies or those post production.

```{r revenue-distribution}
movies %>%
  summarise(meanrev = mean(revenue))

#Plot log(revenue + .01) because log(0) is undefined and 1 cent makes a negligible difference
ggplot(data = movies, aes(log(revenue + .01))) +
  geom_histogram(binwidth = 1) +
  labs(title = "Distribution of Movie Revenue")
```

Mean revenue within the dataset is \$82,260,639 and the data is left-skewed. A significant number of movies brought in \$0 in revenue, and when we remove these films the mean revenue changes.

```{r zero-revenue-distribution}
rev_movies <- movies %>%
  filter(revenue != 0)

rev_movies %>%
  summarise(meanrev = mean(revenue))

#Plot log(revenue)
ggplot(data = rev_movies, aes(log(revenue))) +
  geom_histogram(binwidth = 1) +
  labs(title = "Distribution of Movie Revenue", subtitle = "Excluding Zero-Revenue Productions")
```

The mean revenue for all films with net profit is \$117,031,353. We will consider any film with a greater revenue than this mean to have a "high" revenue.

```{r distribution-votes}
ggplot(data = movies, aes(vote_average)) +
  geom_histogram() +
  labs(title = "Distribution of Vote Average")

movies <- movies %>%
  mutate(high_rev = case_when(
    revenue > 117031353 ~ "yes",
    revenue <= 117031353 ~ "no"
  ))

ggplot(data = movies, aes(x = vote_average, y = revenue, color = high_rev)) +
  geom_point(alpha = 0.3) +
  labs(title = "Vote Average vs. Revenue")
```

We examine the distribution of average ratings given to the movies in the set and look at the relationship between vote_average and revenue to determine if there is a correlation between people thinking a movie is good and having a high revenue. There seems to be an interesting selection of outlier films with extremely high ratings and no revenue. Perhaps we can investigate the variable vote_count to determine if a low vote count for a lesser-known film could skew this vote and lead to outliers.

Statistical methods that will likely be useful in answering our question include backwards model selection (to determine with which variables together form the best linear model for revenue), as well as hypothesis testing (conducting a null hypothesis test for independence between revenue and other variables which we suspect correlate).

We could conduct a null hypothesis test for independence between revenue and budget (although likely we will establish other categorical filters first, like examining the relationship per production company or within each genre). We would need a p-value less than .05 to reject the null hypothesis test and confirm that budget does in fact correlate to revenue.

```{r budget-vs-revenue}
ggplot(data = movies, aes(x = budget, y = revenue, color = high_rev)) +
  geom_point(alpha = .5) +
  labs(title = "Budget vs. Revenue")
```

When comparing budget and revenue, it appears there may be an upward trend: an increase in budget may correlate to an increase in revenue. Investigation of outliers here (movies with large budgets and low revenues, or small budgets and high revenues) could reveal interesting trends.

```{r graph}
movies %>%
  ggplot(mapping= aes(original_language, log(revenue + .01))) +
  geom_boxplot() +
  coord_flip()
```


```{r-language}
new <- movies %>%
  group_by(original_language) %>%
  summarise(means = mean(revenue)) 
new %>%
  ggplot(mapping = aes(original_language, means)) +
  geom_bar(stat = "identity")

```

Here, you can see that the average revenue for each language. English, Japanese, and Telugu have the largest mean revenues. However, it should be noted that in the dataset, movies with the original language ot Telugu is very minimal, thus the average would only be based on these few movies. These languages having the highest revenue could be explained by a few factors: how many native speakers there are of that language, the popularity and amount of films produced in those countries with the specified language each year, among other factors. 

## Section 3. Data

```{r data-info}
glimpse(movies)
```

