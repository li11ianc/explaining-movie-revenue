---
title: "How Does Hollywood Bring In the Big Bucks?"
author: "zuck(R)berg"
date: "03/29/19"
output: github_document
---

## Section 1. Introduction


The dataset we are using is “TMBD 5000 Movie Dataset.” 

Originally, we found this set on kaggle.com. The data originates from “The Movie Database” API, it was collected from this original dataset.

The data’s variables: 
budget
genres
homepage
id
keywords
original_language
original_title
overview
popularity
production_companies
production_countries
release_date
revenue
runtime
spoken_languages
status
tagline
title
vote_average
Vote_count

We aim to investigate which features of a movie correspond to higher profits. Which variables from the dataset correlate to a high revenue rate? 

## Section 2. Data Analysis Plan

Our outcome variable is revenue, and predictors would include but not be limited to the following variables: budget, production_companies, keywords, spoken_languages, original_language, release_date, and vote_average.

```{r load-data, message=FALSE}
library(tidyverse)

movies <- read_csv("tmdb_5000_movies.csv")
movies <- movies %>%
  select(-id, -homepage, -original_title, -popularity)
```

We remove the variables id, homepage, original_title, and popularity to form an updated 16 column dataset- we will not use these in our analysis. We also filter the data so we will only be considering released movies, not rumored movies or those post production.

```{r revenue-distribution}
movies %>%
  summarise(meanrev = mean(revenue))

#Plot log(revenue + .01) because log(0) is undefined and 1 cent makes a negligible difference
ggplot(data = movies, aes(log(revenue + .01))) +
  geom_histogram(binwidth = 1) +
  labs(title = "Distribution of Movie Revenue")
```

Mean revenue within the dataset is \$82,260,639 and the data is left-skewed. A significant number of movies brought in \$0 in revenue, and when we remove these films the mean revenue changes.

```{r zero-revenue-distribution}
rev_movies <- movies %>%
  filter(revenue != 0)

rev_movies %>%
  summarise(meanrev = mean(revenue))

#Plot log(revenue)
ggplot(data = rev_movies, aes(log(revenue))) +
  geom_histogram(binwidth = 1) +
  labs(title = "Distribution of Movie Revenue", subtitle = "Excluding Zero-Revenue Productions")
```

The mean revenue for all films with net profit is \$117,031,353. We will consider any film with a greater revenue than this mean to have a "high" revenue.

```{r distribution-votes}
ggplot(data = movies, aes(vote_average)) +
  geom_histogram() +
  labs(title = "Distribution of Vote Average")

movies <- movies %>%
  mutate(high_rev = case_when(
    revenue > 117031353 ~ "yes",
    revenue <= 117031353 ~ "no"
  ))

ggplot(data = movies, aes(x = vote_average, y = revenue, color = high_rev)) +
  geom_point(alpha = 0.3) +
  labs(title = "Vote Average vs. Revenue")
```

We examine the distribution of average ratings given to the movies in the set and look at the relationship between vote_average and revenue to determine if there is a correlation between people thinking a movie is good and having a high revenue. There seems to be an interesting selection of outlier films with extremely high ratings and no revenue. Perhaps we can investigate the variable vote_count to determine if a low vote count for a lesser-known film could skew this vote and lead to outliers.

```{r graph}
movies %>%
  ggplot(mapping= aes(original_language, log(revenue + .01))) +
  geom_boxplot() +
  coord_flip()
```

## Section 3. Data

```{r data-info}
glimpse(movies)
```

